<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario de Turnos 2026</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            min-height: 100vh;
            padding: 10px;
        }
        .header { text-align: center; padding: 15px; color: #fff; }
        .header h1 { font-size: 1.8rem; }
        .filters-panel {
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            padding: 12px;
            margin-bottom: 12px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .filters-row {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            align-items: flex-end;
            justify-content: center;
        }
        .filter-group { display: flex; flex-direction: column; gap: 4px; }
        .filter-group label { color: #fff; font-size: 0.75rem; font-weight: 600; }
        .filter-group select, .filter-group input {
            padding: 8px 12px;
            border: none;
            border-radius: 8px;
            font-size: 0.9rem;
            min-width: 180px;
        }
        .employee-info {
            background: rgba(255,255,255,0.95);
            border-radius: 12px;
            padding: 12px 15px;
            margin-bottom: 12px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
            display: none;
        }
        .employee-info.active { display: block; }
        .employee-badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 5px;
        }
        .badge-crew { background: #667eea; color: white; }
        .badge-role { background: #27ae60; color: white; }
        .legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
            padding: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            max-width: 1400px;
            margin-left: auto;
            margin-right: auto;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 4px;
            color: #fff;
            font-size: 0.7rem;
            padding: 4px 8px;
            background: rgba(0,0,0,0.2);
            border-radius: 10px;
        }
        .legend-color {
            width: 14px;
            height: 14px;
            border-radius: 50%;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            max-width: 1400px;
            margin: 0 auto;
        }
        .month-card {
            background: rgba(255,255,255,0.98);
            border-radius: 12px;
            padding: 8px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.2);
        }
        .month-header {
            text-align: center;
            padding: 8px;
            margin: -8px -8px 8px -8px;
            background: linear-gradient(145deg, #667eea, #764ba2);
            border-radius: 12px 12px 0 0;
            color: white;
        }
        .calendar-table { width: 100%; border-collapse: separate; border-spacing: 2px; }
        .calendar-table th { padding: 4px 2px; text-align: center; font-weight: 700; color: #555; font-size: 0.6rem; }
        .calendar-table td {
            text-align: center;
            padding: 2px 1px;
            border-radius: 4px;
            font-size: 0.65rem;
            height: 32px;
            vertical-align: middle;
            cursor: pointer;
        }
        .day-num { font-weight: 700; display: block; font-size: 0.7rem; }
        .shift-code { font-size: 0.45rem; font-weight: 600; display: block; }
        .shift-wm { background: rgb(146, 208, 80) !important; color: #1a5c1a !important; }
        .shift-wt { background: rgb(255, 192, 0) !important; color: #5a4000 !important; }
        .shift-n8 { background: rgb(0, 32, 96) !important; color: white !important; }
        .shift-c { background: rgb(200, 200, 200) !important; color: #444 !important; }
        .shift-v { background: rgb(255, 0, 0) !important; color: white !important; }
        .libre { background: #f8f8f8; color: #ddd; }
        .festivo { border: 2px solid rgb(220, 53, 69) !important; }
        .select-message { text-align: center; padding: 50px 20px; color: #fff; font-size: 1.1rem; }
        .select-message span { font-size: 3rem; display: block; margin-bottom: 15px; }
        .stats-container {
            max-width: 1400px;
            margin: 20px auto;
            padding: 15px;
            background: rgba(255,255,255,0.1);
            border-radius: 12px;
            display: none;
        }
        .stats-title { color: #fff; text-align: center; margin-bottom: 12px; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 8px; }
        .stat-card { background: rgba(255,255,255,0.95); padding: 10px 6px; border-radius: 8px; text-align: center; }
        .stat-number { font-size: 1.4rem; font-weight: 800; }
        .stat-label { color: #666; font-size: 0.55rem; }
        @media (max-width: 1000px) { .calendar-grid { grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 600px) { .calendar-grid { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<div class="header">
    <h1>游늰 Calendario de Turnos 2026</h1>
    <p style="color:#a0a0a0; font-size:0.85rem;">Dos Hermanas - Selecciona un empleado</p>
    <div id="employeeCount" style="color:#7bed9f; font-size:0.75rem; margin-top:5px;"></div>
</div>

<div class="filters-panel">
    <div class="filters-row">
        <div class="filter-group">
            <label>游논 Crew:</label>
            <select id="filterCrew" onchange="filterEmployees()">
                <option value="">Todos</option>
            </select>
        </div>
        <div class="filter-group">
            <label>游녻 Persona:</label>
            <select id="filterEmployee" onchange="selectEmployee()">
                <option value="">-- Selecciona --</option>
            </select>
        </div>
        <div class="filter-group">
            <label>游댌 Buscar:</label>
            <input type="text" id="searchInput" placeholder="Nombre o login..." oninput="filterEmployees()">
        </div>
    </div>
</div>

<div class="employee-info" id="employeeInfo">
    <h2 id="employeeName">Nombre</h2>
    <span class="employee-badge badge-crew" id="employeeCrew">CREW</span>
    <span class="employee-badge badge-role" id="employeeRole">ROLE</span>
</div>

<div class="legend">
    <div class="legend-item"><div class="legend-color" style="background:rgb(146,208,80)"></div><span>M8/WM</span></div>
    <div class="legend-item"><div class="legend-color" style="background:rgb(255,192,0)"></div><span>T8/WT</span></div>
    <div class="legend-item"><div class="legend-color" style="background:rgb(0,32,96)"></div><span>N8</span></div>
    <div class="legend-item"><div class="legend-color" style="background:rgb(200,200,200)"></div><span>C</span></div>
    <div class="legend-item"><div class="legend-color" style="background:rgb(255,0,0)"></div><span>V</span></div>
</div>

<div class="calendar-grid" id="calendarGrid">
    <div class="select-message"><span>游녡</span>Selecciona una persona</div>
</div>

<div class="stats-container" id="statsContainer">
    <h3 class="stats-title">游늵 Resumen</h3>
    <div class="stats-grid" id="statsGrid"></div>
</div>

<script>
// DATOS EMBEBIDOS - Aqu칤 est치n los empleados
const DATOS_TSV = `GRUPO 1A	IMMALLEN	Israel Perez Mallen		SRMET	0	0	0	25	25	0	0.00			m8	m8	m-co		wm			wm	wm	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			wt	wt	wt			m8	m-co	m-co	m-co				m-co	m-co	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m-co			n-co	n-co	n	n				wt	wt		wm	wm		wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8		nn	n8			wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n	n8	n8	n8			t8	t8	t8			m8	m8				wm	wm	wm	wm		wt	wt	wt	wt			wm	wm	wm	m-co				wm	wm	wm	m-co	
GRUPO 1A	JAVIFRAC	Francisco Javier Barrero		RMET	0	0	0	22	22	0	0.00			m8	m8	m-co		wm			wm	wm	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			wt	wt	wt			m8	m-co	m-co	m-co				m-co	m-co	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m-co			n-co	n-co	n	n				wt	wt		wm	wm		wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8		nn	n8			wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n	n8	n8	n8			t8	t8	t8			m8	m8				wm	wm	wm	wm		wt	wt	wt	wt			wm	wm	wm	m-co				wm	wm	wm	m-co	
GRUPO 1A	LAVADOIL	Inmaculada Hueso Lavado		RMET	0	0	0	22	22	0	0.00			m8	m8	m-co		wm			wm	wm	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			wt	wt	wt			m8	m-co	m-co	m-co				m-co	m-co	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m-co			n-co	n-co	n	n				wt	wt		wm	wm		wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	m8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8		nn	n8			wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n	n8	n8	n8			t8	t8	t8			m8	m8				wm	wm	wm	wm		wt	wt	wt	wt			wm	wm	wm	m-co				wm	wm	wm	m-co	
GRUPO 1A	PINTODOM	Daniel Pinto Dominguez		RMEO	0	0	0	22	22	0	0.00			m8	m8	m-co		wm			wm	wm	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			wt	wt	wt			m8	m-co	m-co	m-co				m-co	m-co	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m-co			n-co	n-co	n	n				wt	wt		wm	wm		wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n	n	n		nn			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8		nn	n8			wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n	n8	n8	n8			t8	t8	t8			m8	m8				wm	wm	wm	wm		wt	wt	wt	wt			wm	wm	wm	m-co				wm	wm	wm	m-co	
GRUPO 1B	NAVARAFR	Rafael Navarro Gonzalez		SRMET	0	0	0	25	25	0	0.00		nn			t-co		wt			wm	wm	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8				t-co	t-co			m-co	m-co	m8	m8	m8			m8	m8	wt	wt	wt	wt				wm	wm	m-co	m-co	m-co			m8	m8	m8			nn	n8	n				wt	wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8				wm	wm			n	n		nn	n8			wt	wt		wm	wm	wm	wm				wt	wt	wt	wt					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8					wt			wm	wm	m8	m8	m8			m8	m8	wt	wt	wt	t-co				wm	wm	wm	m-co	
GRUPO 1B	PBERNALV	Pedro Bernal Vargas		RMET	0	0	0	22	22	0	0.00		nn			t-co		wt			wm	wm	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8				t-co	t-co			m-co	m-co	m8	m8	m8			m8	m8	wt	wt	wt	wt				wm	wm	m-co	m-co	m-co			m8	m8	m8			nn	n8	n				wt	wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8				wm	wm			n	n		nn	n8			wt	wt		wm	wm	wm	wm				wt	wt	wt	wt					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8					wt			wm	wm	m8	m8	m8			m8	m8	wt	wt	wt	t-co				wm	wm	wm	m-co	
GRUPO 2A	MAJOMA	Jose Maria Mejias Martin		SRMET	0	0	0	25	25	0	0.00		wm			n-co		nn	n	n			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	V25	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			n-co	n-co	n-co					t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	t-co	t-co				wm	wm	wm	wm				m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	TR	TR			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt					wm	wm	wm	wm				wm	wm			n	n	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm					nn	n	n			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	t-co	
GRUPO 2B	CABRADR	Adrian Benitez Cabrera		SRMET	0	0	0	25	25	0	0.00			t8	wt	t-co		wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n	n			wt		wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t-co		m-co	m-co					nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m-co			m-co	m-co	wt	wt	wt	wt				wm	wm	wm		wm			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n	n			wt		wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8		wt	wt	wt	wt				wm	wm	wm	wm			m8	m8	m8			n8	n8		nn			wt	wt	wt		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8			wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8	m-co	
GRUPO 3A	SERMOAR	Sergio Moreno Arteaga		SRMET	0	0	0	25	25	0	0.00			n	n			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			wm	wm	wm				nn	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n-co			t-co			t-co	t-co		wm	wm	wm	wm			nn	n8	n8	n8	n8			wt	wt	t-co			m-co	m-co	m8	m8	m8			m8	m8	wt	wt	wt		wt			m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			wm	wm	wm				nn	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8		wm	wm			wm	wm		wt	wt	wt	wt			m8	m8	m8	m8	m8				wm	wm			n	n	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8				wt	wt	t8	t8		wm	wm	wm	wm			nn	n	n	n				wt	wt	wt		
GRUPO 3B	JOSEDH	Jose Dominguez Huelva		SRMET	0	0	0	25	25	0	0.00		wt					nn	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8				n-co	n-co			nn	n-co			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n-co	n-co	n-co			t8	t8	t8			m8	m8	wm	wm				wm	wm	wt	wt	wt	wt				m8	m8	m8	m8	m8			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8			t8	t8	t8			m8	m8	m8	m8	m8			m8	m8	wt	wt	wt	wt				wm	wm	wm	wm				m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8					n8	n8	n8	n8	n8			t8	t8	t8	t8	t8		wm	wm	wm	wm			nn	n8	n8	n8	n8				wt	wt			wm	wm		wm	wm			wm	wm	wt	wt	wt	wt					wm	wm	wm	wm			m8	m8	m8			n8	n8	n8	n8			t8	t8	t8		wm	wm	wm	wm			t8	t8	t8	t8	t8						n	n	n	n			t8	t8	t8	t8	t8		wm	wm	m-co				nn	n	n	n`;

// Festivos 2026
const festivos2026 = [
    {month:1,day:1,name:"A침o Nuevo"},{month:1,day:6,name:"Reyes"},
    {month:2,day:28,name:"D칤a de Andaluc칤a"},{month:4,day:2,name:"Jueves Santo"},
    {month:4,day:3,name:"Viernes Santo"},{month:5,day:1,name:"D칤a del Trabajo"},
    {month:8,day:15,name:"Asunci칩n"},{month:10,day:12,name:"Fiesta Nacional"},
    {month:11,day:1,name:"Todos los Santos"},{month:12,day:6,name:"Constituci칩n"},
    {month:12,day:8,name:"Inmaculada"},{month:12,day:25,name:"Navidad"}
];

const monthNames = ['ENERO','FEBRERO','MARZO','ABRIL','MAYO','JUNIO','JULIO','AGOSTO','SEPTIEMBRE','OCTUBRE','NOVIEMBRE','DICIEMBRE'];
const daysInMonth = [31,28,31,30,31,30,31,31,30,31,30,31];
const startDays = [4,0,0,3,5,1,3,6,2,4,0,2];

let allData = null;
let selectedEmployee = null;

// Parsear TSV
function parseRawData(rawData) {
    const lines = rawData.trim().split('\n');
    const empleados = [];
    
    lines.forEach(line => {
        const parts = line.split('\t');
        if (parts.length < 5) return;
        
        const crew = parts[0].trim();
        const login = parts[1].trim();
        const name = parts[2].trim();
        const role = parts[4].trim();
        
        if (!login || !name) return;
        
        let turnoStart = 11;
        const turnos = [];
        for (let i = turnoStart; i < parts.length && turnos.length < 365; i++) {
            turnos.push((parts[i] || '').trim().toLowerCase());
        }
        while (turnos.length < 365) turnos.push('');
        
        empleados.push({ crew, login, name, role, turnos: turnos.slice(0, 365) });
    });
    
    return empleados;
}

// Inicializar
function init() {
    const empleados = parseRawData(DATOS_TSV);
    allData = { empleados, festivos: festivos2026 };
    document.getElementById('employeeCount').textContent = `游늵 ${empleados.length} empleados cargados`;
    initializeFilters();
}

function initializeFilters() {
    const crews = [...new Set(allData.empleados.map(e => e.crew))].sort();
    const crewSelect = document.getElementById('filterCrew');
    crewSelect.innerHTML = '<option value="">Todos</option>';
    crews.forEach(c => crewSelect.innerHTML += `<option value="${c}">${c}</option>`);
    filterEmployees();
}

function filterEmployees() {
    const crewFilter = document.getElementById('filterCrew').value;
    const searchFilter = document.getElementById('searchInput').value.toLowerCase();
    let filtered = allData.empleados;
    if (crewFilter) filtered = filtered.filter(e => e.crew === crewFilter);
    if (searchFilter) filtered = filtered.filter(e => 
        e.name.toLowerCase().includes(searchFilter) || 
        e.login.toLowerCase().includes(searchFilter)
    );
    const empSelect = document.getElementById('filterEmployee');
    empSelect.innerHTML = '<option value="">-- Selecciona --</option>';
    filtered.sort((a,b) => a.name.localeCompare(b.name));
    filtered.forEach(e => empSelect.innerHTML += `<option value="${e.login}">${e.name}</option>`);
}

function selectEmployee() {
    const login = document.getElementById('filterEmployee').value;
    if (!login) {
        selectedEmployee = null;
        document.getElementById('employeeInfo').classList.remove('active');
        document.getElementById('statsContainer').style.display = 'none';
        document.getElementById('calendarGrid').innerHTML = '<div class="select-message"><span>游녡</span>Selecciona una persona</div>';
        return;
    }
    selectedEmployee = allData.empleados.find(e => e.login === login);
    document.getElementById('employeeName').textContent = selectedEmployee.name;
    document.getElementById('employeeCrew').textContent = selectedEmployee.crew;
    document.getElementById('employeeRole').textContent = selectedEmployee.role;
    document.getElementById('employeeInfo').classList.add('active');
    generateCalendar();
    generateStats();
    document.getElementById('statsContainer').style.display = 'block';
}

function getShiftClass(shift) {
    if (!shift) return 'libre';
    const s = shift.toLowerCase().replace('-co','');
    if (s === 'wm' || s === 'm8' || s === 'm') return 'shift-wm';
    if (s === 'wt' || s === 't8' || s === 't') return 'shift-wt';
    if (s === 'n8' || s === 'n' || s === 'nn') return 'shift-n8';
    if (s === 'c') return 'shift-c';
    if (s === 'v' || s === 'v25' || s === 'v26') return 'shift-v';
    return 'libre';
}

function isFestivo(m, d) { return festivos2026.some(f => f.month === m && f.day === d); }
function getDayOfYear(m, d) { let doy = 0; for (let i = 0; i < m - 1; i++) doy += daysInMonth[i]; return doy + d - 1; }

function generateMonth(month) {
    let html = `<div class="month-card"><div class="month-header"><h2>${monthNames[month-1]}</h2></div><table class="calendar-table"><thead><tr><th>D</th><th>L</th><th>M</th><th>X</th><th>J</th><th>V</th><th>S</th></tr></thead><tbody>`;
    let day = 1;
    const weeks = Math.ceil((daysInMonth[month-1] + startDays[month-1]) / 7);
    for (let w = 0; w < weeks; w++) {
        html += '<tr>';
        for (let d = 0; d < 7; d++) {
            if ((w === 0 && d < startDays[month-1]) || day > daysInMonth[month-1]) {
                html += '<td></td>';
            } else {
                const doy = getDayOfYear(month, day);
                let turno = (selectedEmployee.turnos[doy] || '').replace('-co','');
                const fest = isFestivo(month, day);
                let classes = [getShiftClass(turno)];
                if (fest) classes.push('festivo');
                html += `<td class="${classes.join(' ')}"><span class="day-num">${day}</span><span class="shift-code">${turno ? turno.toUpperCase() : ''}</span></td>`;
                day++;
            }
        }
        html += '</tr>';
    }
    html += '</tbody></table></div>';
    return html;
}

function generateCalendar() {
    let html = '';
    for (let m = 1; m <= 12; m++) html += generateMonth(m);
    document.getElementById('calendarGrid').innerHTML = html;
}

function generateStats() {
    let stats = {verde:0, naranja:0, azul:0, gris:0, vac:0};
    for (let doy = 0; doy < 365; doy++) {
        let turno = (selectedEmployee.turnos[doy] || '').toLowerCase().replace('-co','');
        if (turno === 'wm' || turno === 'm8' || turno === 'm') stats.verde++;
        else if (turno === 'wt' || turno === 't8' || turno === 't') stats.naranja++;
        else if (turno === 'n8' || turno === 'n' || turno === 'nn') stats.azul++;
        else if (turno === 'c') stats.gris++;
        else if (turno === 'v' || turno === 'v25' || turno === 'v26') stats.vac++;
    }
    document.getElementById('statsGrid').innerHTML = `
        <div class="stat-card"><div class="stat-number" style="color:green">${stats.verde}</div><div class="stat-label">MA칌ANA</div></div>
        <div class="stat-card"><div class="stat-number" style="color:orange">${stats.naranja}</div><div class="stat-label">TARDE</div></div>
        <div class="stat-card"><div class="stat-number" style="color:darkblue">${stats.azul}</div><div class="stat-label">NOCHE</div></div>
        <div class="stat-card"><div class="stat-number" style="color:gray">${stats.gris}</div><div class="stat-label">CENTRAL</div></div>
        <div class="stat-card"><div class="stat-number" style="color:red">${stats.vac}</div><div class="stat-label">VACACIONES</div></div>
    `;
}

// Iniciar
init();
</script>

</body>
</html>
